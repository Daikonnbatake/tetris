/***********************************************************************
 *
 * 　キー毎の入力状態を監視するクラス.
 *
***********************************************************************/

class KeyObserver
{
    #state; // number: 監視しているキーの状態.


    /*-----------------------------------------------------------------+
    *
    * 説明: コンストラクタ.
    *
    +-----------------------------------------------------------------*/
    constructor()
    {
        this.#state = KeyState.Idle();
    }


    /*-----------------------------------------------------------------+
    *
    * 説明: 状態を取得する.
    *
    * 戻り値:
    *   number: キーの状態.
    *
    +-----------------------------------------------------------------*/
    GetState()
    {
        return this.#state;
    }


    /*-----------------------------------------------------------------+
    *
    * 説明: キーが押された事を通知する.
    *
    +-----------------------------------------------------------------*/
    OnPush()
    {
        let hold = KeyState.Hold();
        if (this.#state != hold) this.#state = KeyState.Push();
    }


    /*-----------------------------------------------------------------+
    *
    * 説明: キーが離された事を通知する.
    *
    +-----------------------------------------------------------------*/
    OnPull()
    {
        this.#state = KeyState.Pull();
    }


    /*-----------------------------------------------------------------+
    *
    * 説明: 状態を更新する.
    *
    +-----------------------------------------------------------------*/
    Update()
    {
        let idle = KeyState.Idle();
        let push = KeyState.Push();
        let pull = KeyState.Pull();
        let hold = KeyState.Hold();

        if (this.#state === push) this.#state = hold;
        if (this.#state === pull) this.#state = idle;
    }
}